const express 	  = require('express');
const path		    = require('path');
const MongoClient = require('mongodb').MongoClient;
const assert      = require('assert');
const config      = require('./server/config');

const app = express();

// Use connect method to connect to the server
MongoClient.connect(config.MONGODB_URI, function(err, db) {
  if (err) {
    console.error(err);
  }
  console.log("Connected successfully to server");
});

//////////////////////////////////////////////////////////////////////////////////
// APP SETUP
//////////////////////////////////////////////////////////////////////////////////
app.use(express.static(__dirname + '/dist'));

//////////////////////////////////////////////////////////////////////////////////
// APP ROUTES
//////////////////////////////////////////////////////////////////////////////////
app.get('/', (req, res) => {
  res.sendFile(__dirname + '/dist/index.html');
});

//////////////////////////////////////////////////////////////////////////////////
// STARTING SERVER
//////////////////////////////////////////////////////////////////////////////////
const server = app.listen(config.port, () => {
  console.log(`ğŸš€ Server listening on port ${server.address().port}`);
});
